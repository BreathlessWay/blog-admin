(this["webpackJsonpblog-admin"]=this["webpackJsonpblog-admin"]||[]).push([[12],{694:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(147),n=r.n(a),i=function(e){var t=e.replace(/^\?(.*)$/,"$1");return t?n.a.parse(t):null}},835:function(e,t,r){"use strict";r.r(t);var a,n=r(657),i=r.n(n),c=r(11),o=r(12),l=r(33),u=r(31),s=r(32),d=(r(206),r(132)),p=r(0),h=r.n(p),f=r(130),m=r(68),b=r(23),v=r(694),g=r(101),y=r(58),k=Object(p.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(11)]).then(r.bind(null,866))})),j=Object(p.lazy)((function(){return Promise.all([r.e(5),r.e(42),r.e(10)]).then(r.bind(null,889))})),C=Object(p.lazy)((function(){return Promise.all([r.e(44),r.e(9)]).then(r.bind(null,874))})),w=Object(p.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(8)]).then(r.bind(null,876))})),T=d.a.confirm,O=d.a.warning,S=Object(f.b)((function(e){return{articleDetailStore:e.articleDetailStore,tagStore:e.tagStore,homepageStore:e.homepageStore}}))(a=Object(f.c)(a=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(r=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).time=null,r.startCache=function(){r.time=setInterval((function(){var e=r.props.articleDetailStore.detail;if(e){var t=e.title,a=e.intro,n=e.tags,i=e.status,c=e.renderType,o=e.markdown,l=e.draftDetail,u=n.map((function(e){return e.objectId})).filter((function(e){return e})),s="";c===m.c.richText&&l&&l.toText()&&(s=l.toRAW()),c===m.c.markdown&&(s=o);var d={id:r.articleId||"create",data:{title:t,intro:a,tags:u,status:i,renderType:c,detail:s}};g.a.set({key:b.b,value:d})}}),b.c)},r.loadCache=function(){if(r.articleCache){var e=r.articleCache.data,t=e.title,a=e.intro,n=e.tags,i=e.renderType,c=e.status,o=e.detail,l={title:t,intro:a,tags:[],renderType:i,status:Number(c)};n.length&&(l.tags=r.props.tagStore.tags.filter((function(e){return e.objectId&&n.includes(e.objectId)}))),i===m.c.richText&&(l.richTextRaw=o),i===m.c.markdown&&(l.markdown=o),r.props.articleDetailStore.setDetail(l)}r.startCache()},r.getData=function(){var e=r.props.articleDetailStore.createArticle;r.isEdit,r.isCreate&&e()},r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e,t,r;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=(e=this).props.location.pathname,r=e.props.homepageStore.articleAlias,t!==y.e.article.edit||e.articleId){a.next=6;break}return O({title:"\u63d0\u793a",content:"\u7f16\u8f91".concat(r,"\u7f3a\u5c11").concat(r,"id\u53c2\u6570\uff01"),okText:"\u786e\u5b9a",onOk:function(){e.props.history.replace(y.e.article.home)}}),a.abrupt("return");case 6:return a.next=8,i.a.awrap(e.getData());case 8:if(!e.judgeCache){a.next=11;break}return T({title:"\u63d0\u793a",content:"\u60a8\u4f3c\u4e4e\u6709\u4e0a\u4e00\u6b21\u672a\u4fdd\u5b58\u7684\u8349\u7a3f\uff0c\u662f\u5426\u8f7d\u5165\uff1f",keyboard:!1,maskClosable:!1,onOk:function(){e.loadCache()},onCancel:function(){g.a.remove(b.b)}}),a.abrupt("return");case 11:g.a.remove(b.b),e.startCache();case 13:case"end":return a.stop()}}),null,this)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.time),this.time=null,this.props.articleDetailStore.resetError()}},{key:"render",value:function(){var e=this.props.articleDetailStore.detail;return h.a.createElement(h.a.Fragment,null,h.a.createElement(k,null),(null===e||void 0===e?void 0:e.renderType)===m.c.richText&&h.a.createElement(j,null),(null===e||void 0===e?void 0:e.renderType)===m.c.markdown&&h.a.createElement(C,null),h.a.createElement(w,null))}},{key:"judgeCache",get:function(){if(this.articleCache){var e=this.articleCache,t=e.id,r=e.data,a=r.title,n=r.intro,i=r.detail,c=r.tags,o=r.renderType,l=r.status;if(this.isCreate&&"create"===t)return Boolean(a||n||i||c.length);if(this.isEdit&&t===this.articleId){var u=this.props.articleDetailStore.detail;if(u){if(a!==u.title||n!==u.intro||o!==u.renderType||Number(l)!==u.status)return!0;if(u.tags.map((function(e){return e.objectId})).join()!==c.join())return!0;if(o===m.c.markdown&&i!==u.markdown)return!0;if(o===m.c.richText&&i!==u.richTextRaw)return!0}}}return!1}},{key:"articleCache",get:function(){return g.a.get(b.b)}},{key:"articleId",get:function(){var e,t;return null!==(e=null===(t=Object(v.a)(this.props.location.search))||void 0===t?void 0:t.id)&&void 0!==e?e:null}},{key:"isCreate",get:function(){return this.props.location.pathname===y.e.article.create}},{key:"isEdit",get:function(){var e=this.props.location,t=e.search,r=e.pathname;return t&&r===y.e.article.edit}}]),t}(p.Component))||a)||a;t.default=S}}]);