(this["webpackJsonpblog-admin"]=this["webpackJsonpblog-admin"]||[]).push([[12],{708:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var a=r(159),n=r.n(a),i=function(t){var e=t.replace(/^\?(.*)$/,"$1");return e?n.a.parse(e):null}},852:function(t,e,r){"use strict";r.r(e);var a,n=r(670),i=r.n(n),c=r(11),l=r(12),o=r(36),u=r(34),s=r(35),d=(r(222),r(143)),h=r(0),p=r.n(h),f=r(140),m=r(73),b=r(25),v=r(708),g=r(105),y=r(63),k=Object(h.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(11)]).then(r.bind(null,883))})),j=Object(h.lazy)((function(){return Promise.all([r.e(6),r.e(42),r.e(10)]).then(r.bind(null,905))})),C=Object(h.lazy)((function(){return Promise.all([r.e(44),r.e(9)]).then(r.bind(null,891))})),w=Object(h.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(8)]).then(r.bind(null,893))})),T=d.a.confirm,O=d.a.warning,D=Object(f.b)((function(t){return{articleDetailStore:t.articleDetailStore,tagStore:t.tagStore}}))(a=Object(f.c)(a=function(t){function e(){var t,r;Object(c.a)(this,e);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(r=Object(o.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(n)))).time=null,r.startCache=function(){r.time=setInterval((function(){var t=r.props.articleDetailStore.detail;if(t){var e=t.title,a=t.intro,n=t.tags,i=t.status,c=t.renderType,l=t.markdown,o=t.draftDetail,u=n.map((function(t){return t.objectId})).filter((function(t){return t})),s="";c===m.c.richText&&o&&o.toText()&&(s=o.toRAW()),c===m.c.markdown&&(s=l);var d={id:r.articleId||"create",data:{title:e,intro:a,tags:u,status:i,renderType:c,detail:s}};g.a.set({key:b.b,value:d})}}),b.c)},r.loadCache=function(){if(r.articleCache){var t=r.articleCache.data,e=t.title,a=t.intro,n=t.tags,i=t.renderType,c=t.status,l=t.detail,o={title:e,intro:a,tags:[],renderType:i,status:Number(c)};n.length&&(o.tags=r.props.tagStore.tags.filter((function(t){return t.objectId&&n.includes(t.objectId)}))),i===m.c.richText&&(o.richTextRaw=l),i===m.c.markdown&&(o.markdown=l),r.props.articleDetailStore.setDetail(o)}r.startCache()},r.getData=function(){var t=r.props.articleDetailStore.createArticle;r.isEdit,r.isCreate&&t()},r}return Object(s.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t,e;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.props.location.pathname,e=this,t!==y.d.article.edit||this.articleId){r.next=5;break}return O({title:"\u63d0\u793a",content:"\u7f16\u8f91\u6587\u7ae0\u7f3a\u5931\u6587\u7ae0id\u53c2\u6570\uff01",okText:"\u786e\u5b9a",onOk:function(){e.props.history.replace(y.d.article.home)}}),r.abrupt("return");case 5:return r.next=7,i.a.awrap(this.getData());case 7:if(!this.judgeCache){r.next=10;break}return T({title:"\u63d0\u793a",content:"\u60a8\u4f3c\u4e4e\u6709\u4e0a\u4e00\u6b21\u672a\u4fdd\u5b58\u7684\u8349\u7a3f\uff0c\u662f\u5426\u8f7d\u5165\uff1f",keyboard:!1,maskClosable:!1,onOk:function(){e.loadCache()},onCancel:function(){g.a.remove(b.b)}}),r.abrupt("return");case 10:g.a.remove(b.b),this.startCache();case 12:case"end":return r.stop()}}),null,this)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.time),this.time=null,this.props.articleDetailStore.resetError()}},{key:"render",value:function(){var t=this.props.articleDetailStore.detail;return p.a.createElement(p.a.Fragment,null,p.a.createElement(k,null),(null===t||void 0===t?void 0:t.renderType)===m.c.richText&&p.a.createElement(j,null),(null===t||void 0===t?void 0:t.renderType)===m.c.markdown&&p.a.createElement(C,null),p.a.createElement(w,null))}},{key:"judgeCache",get:function(){if(this.articleCache){var t=this.articleCache,e=t.id,r=t.data,a=r.title,n=r.intro,i=r.detail,c=r.tags,l=r.renderType,o=r.status;if(this.isCreate&&"create"===e)return Boolean(a||n||i||c.length);if(this.isEdit&&e===this.articleId){var u=this.props.articleDetailStore.detail;if(u){if(a!==u.title||n!==u.intro||l!==u.renderType||Number(o)!==u.status)return!0;if(u.tags.map((function(t){return t.objectId})).join()!==c.join())return!0;if(l===m.c.markdown&&i!==u.markdown)return!0;if(l===m.c.richText&&i!==u.richTextRaw)return!0}}}return!1}},{key:"articleCache",get:function(){return g.a.get(b.b)}},{key:"articleId",get:function(){var t,e;return null!==(t=null===(e=Object(v.a)(this.props.location.search))||void 0===e?void 0:e.id)&&void 0!==t?t:null}},{key:"isCreate",get:function(){return this.props.location.pathname===y.d.article.create}},{key:"isEdit",get:function(){var t=this.props.location,e=t.search,r=t.pathname;return e&&r===y.d.article.edit}}]),e}(h.Component))||a)||a;e.default=D}}]);
//# sourceMappingURL=ArticleEditPage.9f2d2310.chunk.js.map